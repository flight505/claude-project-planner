% Project Planning Report Template for Pandoc
% Usage: pandoc input.md -o output.pdf --template=report_template.tex

\documentclass[11pt,a4paper]{article}

% Packages
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage[margin=1in]{geometry}
\usepackage{hyperref}
\usepackage{xcolor}
\usepackage{graphicx}
\usepackage{booktabs}
\usepackage{longtable}
\usepackage{fancyhdr}
\usepackage{titlesec}
\usepackage{tocloft}
\usepackage{float}

% Colors
\definecolor{linkblue}{RGB}{0, 102, 204}
\definecolor{headerblue}{RGB}{0, 51, 102}

% Hyperref setup
\hypersetup{
    colorlinks=true,
    linkcolor=linkblue,
    urlcolor=linkblue,
    citecolor=linkblue,
    pdftitle={$if(title)$$title$$endif$},
    pdfauthor={$if(author)$$author$$endif$}
}

% Header/Footer
\pagestyle{fancy}
\fancyhf{}
\fancyhead[L]{\small\leftmark}
\fancyhead[R]{\small $if(title)$$title$$endif$}
\fancyfoot[C]{\thepage}
\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\footrulewidth}{0.4pt}

% Section formatting
\titleformat{\section}
    {\Large\bfseries\color{headerblue}}
    {\thesection}{1em}{}
\titleformat{\subsection}
    {\large\bfseries}
    {\thesubsection}{1em}{}
\titleformat{\subsubsection}
    {\normalsize\bfseries}
    {\thesubsubsection}{1em}{}

% TOC formatting
\renewcommand{\cftsecleader}{\cftdotfill{\cftdotsep}}

% Code blocks
$if(highlighting-macros)$
$highlighting-macros$
$endif$

\usepackage{listings}
\lstset{
    basicstyle=\ttfamily\small,
    breaklines=true,
    frame=single,
    backgroundcolor=\color{gray!10}
}

% Tight list
\providecommand{\tightlist}{%
    \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}
}

% Images
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}

\begin{document}

% Title page
$if(title)$
\begin{titlepage}
\centering
\vspace*{3cm}
{\Huge\bfseries $title$\par}
\vspace{1.5cm}
$if(subtitle)$
{\Large $subtitle$\par}
\vspace{1cm}
$endif$
{\large Project Planning Report\par}
\vspace{2cm}
$if(date)$
{\large $date$\par}
$endif$
\vspace{4cm}
\rule{0.8\textwidth}{0.4pt}
\vspace{0.5cm}
{\small Generated by Claude Project Planner}
\end{titlepage}
$endif$

% Table of contents
$if(toc)$
\tableofcontents
\newpage
$endif$

% Main content
$body$

\end{document}
